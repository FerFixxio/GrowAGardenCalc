<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üå± Grow a Garden Mutation Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Delius&display=swap" rel="stylesheet">
  <style>
    html {
      scroll-behavior: smooth;
    }

    body {
      color: white;
      font-family: 'Delius', Arial, sans-serif;
      margin: 0;
      padding: 8px;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      box-sizing: border-box;
      background: linear-gradient(120deg, #1f3d1f, #1d3a2a, #1c3735 90%);
      background-size: 400% 400%;
      animation: animatedGradient 8s linear infinite;
    }

    @keyframes animatedGradient {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }

    .container {
      display: flex;
      max-width: 1000px;
      width: 100%;
      gap: 10px;
      transition: box-shadow 0.3s;
    }

    .side-panel {
      flex-shrink: 0;
      width: 300px;
      background: #29402944;
      border-radius: 12px;
      padding: 8px;
      margin-bottom: 10px;
      font-size: 14px;
      font-weight: bold;
      line-height: 1.4;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
      height: fit-content;
      position: sticky;
      top: 20px;
      color: #cce5cc;
      transition: background 0.4s, color 0.4s;
      text-shadow: 2px 0 #0000006e, -2px 0 #0000006e, 0 2px #0000006e, 0 -2px #0000006e,1px 1px #0000006e, -1px -1px #0000006e, 1px -1px #0000006e, -1px 1px #0000006e;
    }

    .calculator {
      flex-grow: 1;
      background: #29402944;
      border-radius: 12px;
      padding: 12px 14px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.6);
      display: flex;
      flex-direction: column;
      gap: 8px;
      min-width: 280px;
      transition: background 0.4s;
    }

    h2 {
      text-align: center;
      margin-top: 0;
      margin-bottom: 10px;
      font-weight: 700;
      font-size: 24px;
      color: #a1d99a;
      text-shadow: 0 0 5px #7fb87f;
      font-family: 'Delius', Arial, sans-serif;
      text-shadow: 2px 0 #0000006e, -2px 0 #0000006e, 0 2px #0000006e, 0 -2px #0000006e,1px 1px #0000006e, -1px -1px #0000006e, 1px -1px #0000006e, -1px 1px #0000006e;
      letter-spacing: 0.01em;
      transition: color 0.3s;
    }

    label {
      display: block;
      margin-top: 5px;
      font-weight: 600;
      cursor: pointer;
      font-family: 'Delius', Arial, sans-serif;
      transition: color 0.3s;
    }

    select,
    input[type="number"],
    button {
      width: 100%;
      padding: 8px 10px;
      margin-top: 3px;
      border-radius: 8px;
      border: none;
      font-size: 16px;
      box-sizing: border-box;
      background-color: #3b663b;
      color: #e6f2e6;
      transition: background-color 0.3s, box-shadow 0.3s;
      font-family: 'Delius', Arial, sans-serif;
    }

    select:hover,
    input[type="number"]:hover,
    button:hover {
      background-color: #4a7d4a;
      box-shadow: 0 2px 8px #2e4e2e33;
    }

    select:focus,
    input[type="number"]:focus {
      outline: 2px solid #a1d99a;
      background-color: #3b663b;
      box-shadow: 0 0 0 2px #a1d99a55;
    }

    button {
      background-color: #4CAF50;
      font-weight: 700;
      cursor: pointer;
      margin-top: 10px;
      box-shadow: 0 4px 10px #3a7d3a;
      transition: background-color 0.25s, box-shadow 0.25s;
      font-family: 'Delius', Arial, sans-serif;
      letter-spacing: 0.02em;
    }

    button:hover {
      background-color: #6bc16b;
      box-shadow: 0 6px 16px #3a7d3a99;
    }

    .result {
      margin-top: 12px;
      background-color: #1e331e;
      padding: 10px;
      border-radius: 12px;
      color: #ffeb3b;
      font-weight: 700;
      font-size: 17px;
      box-shadow: 0 0 2px rgba(25, 156, 20, 0.452);
      white-space: pre-wrap;
      font-family: 'Delius', Arial, sans-serif;
      text-shadow: 2px 0 #0000006e, -2px 0 #0000006e, 0 2px #0000006e, 0 -2px #0000006e,1px 1px #0000006e, -1px -1px #0000006e, 1px -1px #0000006e, -1px 1px #0000006e;
      transition: background 0.3s, color 0.3s;
    }

    .core-mutations {
      display: flex;
      gap: 10px;
      margin-top: 4px;
      flex-wrap: wrap;
      transition: gap 0.3s;
    }

    .mutation-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 15px;
      user-select: none;
      font-family: 'Delius', Arial, sans-serif;
      text-shadow: 2px 0 #0000006e, -2px 0 #0000006e, 0 2px #0000006e, 0 -2px #0000006e,1px 1px #0000006e, -1px -1px #0000006e, 1px -1px #0000006e, -1px 1px #0000006e;
      transition: color 0.3s;
    }

    .env-mutations {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 6px 10px;
      margin-top: 5px;
      transition: gap 0.3s;
    }

    #baseValueLabel {
      margin-top: 7px;
    }

    @media (max-width: 900px) {
      .container {
        max-width: 98vw;
        flex-direction: column;
      }

      .side-panel {
        width: 100%;
        position: relative;
        top: auto;
        margin-bottom: 10px;
      }

      .env-mutations {
        grid-template-columns: repeat(2, 1fr);
        gap: 6px 8px;
      }
    }

    @media (max-width: 600px) {
      html, body {
        min-width: 0;
        width: 100vw;
        max-width: 100vw;
        overflow-x: hidden;
      }
      body {
        flex-direction: column;
        align-items: stretch;
        padding: 0;
        margin: 0;
        background: #223822;
      }
      .container {
        flex-direction: column;
        max-width: 100vw;
        width: 100vw;
        gap: 0;
        align-items: stretch;
        box-shadow: none;
        padding: 0;
      }
      .side-panel {
        width: 100vw;
        min-width: 0;
        max-width: 100vw;
        position: static;
        top: unset;
        margin-bottom: 0;
        border-radius: 0;
        box-shadow: none;
        font-size: 15px;
        padding: 10px 6px 6px 6px;
        background: #294029;
      }
      .calculator {
        min-width: 0;
        width: 100vw;
        max-width: 100vw;
        border-radius: 0 0 0 0;
        padding: 10px 6px 6px 6px;
        box-shadow: none;
        gap: 8px;
        background: #294029;
      }
      h2 {
        font-size: 19px;
        margin-bottom: 8px;
      }
      label {
        font-size: 15px;
        margin-top: 4px;
      }
      select,
      input[type="number"],
      button {
        font-size: 16px;
        padding: 10px 8px;
        margin-top: 3px;
        border-radius: 8px;
      }
      .result {
        font-size: 16px;
        padding: 10px;
        margin-top: 10px;
      }
      .core-mutations {
        gap: 7px;
        font-size: 14px;
        flex-direction: column;
      }
      .mutation-item {
        font-size: 14px;
        gap: 7px;
      }
      .env-mutations {
        grid-template-columns: 1fr;
        gap: 6px 0;
        margin-top: 5px;
      }
      #plantDropdownSearch {
        font-size: 16px;
        padding: 10px 8px;
        height: 40px;
        border-radius: 8px 8px 0 0;
      }
      #plantSelect {
        font-size: 16px;
        padding-top: 40px;
        border-radius: 0 0 8px 8px;
      }
    }

    #plantSelect::-webkit-scrollbar {
      width: 0 !important;
      background: transparent;
    }
    #plantSelect {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    select#plantSelect option {
      transition: background 0.18s, color 0.18s;
      background: #3b663b;
      color: #e6f2e6;
    }
    select#plantSelect option:checked, select#plantSelect:focus option:checked {
      background: linear-gradient(90deg, #4a7d4a 60%, #7fd97f 100%);
      color: #fffbe6;
      font-weight: bold;
      box-shadow: 0 0 0 2px #a1d99a55 inset;
      outline: none;
    }
    select#plantSelect option:hover {
      background: #5fa85f;
      color: #fffbe6;
    }
    select#plantSelect:focus {
      border: 2px solid #a1d99a;
      box-shadow: 0 0 0 2px #a1d99a55;
    }
  </style>
  <meta name="description" content="Grow a Garden Mutation Calculator ‚Äì Calculate plant mutation values for the Grow a Garden game. Instantly estimate plant prices with mutations, search all plants and events, and optimize your garden strategy!" />
  <meta name="keywords" content="grow a garden, mutation calculator, plant calculator, plant value, garden game, plant mutations, event plants, farming, plant price, mutation bonus, grow a garden event, grow a garden plants, grow a garden mutation, grow a garden calculator, plant search, plant event, plant farming, plant profit, plant stack bonus" />
  <meta name="author" content="Grow a Garden Community, GitHub Copilot" />
  <meta property="og:title" content="Grow a Garden Mutation Calculator" />
  <meta property="og:description" content="Calculate plant mutation values for Grow a Garden. Fast, modern UI, all events and bonuses supported. Search and optimize your garden!" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Grow a Garden Mutation Calculator" />
  <meta name="twitter:description" content="Calculate plant mutation values for Grow a Garden. Instantly estimate plant prices, search all plants and events, and optimize your garden strategy!" />
</head>
<body>
  <div class="container">
    <aside class="side-panel">
      <h3>Mutation Explanations &amp; Stats</h3>
      <p><strong>Core Mutations:</strong></p>
      <ul>
        <li style="color:rgb(110, 110, 110);"><b>üåë None:</b> Normal growth (√ó1). Stack‚Äêbonus = +0</li>
        <li style="color:rgb(192, 206, 0);"><b>‚ú® Golden:</b> Multiplies base value by 20√ó. Stack‚Äêbonus = +19</li>
        <li><b style="letter-spacing: 0em;"><span style="color:#FF0000;">R</span><span style="color:#FF7F00;">a</span><span style="color:#FFFF00;">i</span><span style="color:#00FF00;">n</span><span style="color:#0000FF;">b</span><span style="color:#4B0082;">o</span><span style="color:#9400D3;">w</span></b>: Multiplies base value by 50√ó. Stack‚Äêbonus = +49</li>
      </ul>
      <p><strong>Environmental Mutations (Stack‚Äêbonus = original multiplier ‚àí 1):</strong></p>
      <ul>
        <li style="color: rgb(95, 196, 255);">üíß Wet (√ó2) ‚áí +1</li>
        <li style="color: rgb(95, 196, 255);">‚ùÑÔ∏è Chilled (√ó2) ‚áí +1</li>
        <li style="color: rgb(95, 196, 255);">üßä Frozen (√ó10) ‚áí +9 <em>(exclusive with Wet &amp; Chilled)</em></li>
        <li style="color: rgb(109, 56, 13);">üç´ Chocolate (√ó2) ‚áí +1</li>
        <li style="color: rgb(167, 141, 238);">üåô Moonlit (√ó2) ‚áí +1</li>
        <li style="color: rgb(184, 181, 42);">üêù Pollinated (√ó3) ‚áí +2</li>
        <li style="color: rgb(94, 31, 31);">ü©∏ Bloodlit (√ó4) ‚áí +3</li>
        <li style="color: rgb(221, 51, 255);">‚ö° Plasma (√ó5) ‚áí +4</li>
        <li style="color: rgb(255, 159, 33);">üçØ Honey Glazed (√ó5) ‚áí +4</li>
        <li style="color: rgb(132, 173, 108);">üßü Zombified (√ó25) ‚áí +24</li>
        <li style="color: rgb(28, 30, 138);">üåÄ Twisted (√ó30) ‚áí +29</li>
        <li style="color: rgb(225, 253, 63);">‚ö° Shocked (√ó100) ‚áí +99</li>
        <li style="color: rgb(223, 18, 250);">üå† Celestial (√ó120) ‚áí +119</li>
        <li style="color: rgb(242, 146, 255);">üåà Disco (√ó125) ‚áí +124</li>
        <li style="color: rgb(73, 0, 73);">üåå Voidtouched (√ó135) ‚áí +134</li>
      </ul>
      <p><em>Note: ‚ÄúFrozen‚Äù cannot stack with ‚ÄúWet‚Äù or ‚ÄúChilled.‚Äù</em></p>
    </aside>
    <main class="calculator">
      <h2>üåø Grow a Garden Mutation Calculator</h2>
      <label style="margin-bottom: 10px; display: block;">
        <span style="display:block; margin-bottom:7px;">üåæ Select Plant:</span>
        <div style="position:relative; margin-bottom: 8px; width:100%;">
          <input type="text" id="plantDropdownSearch" placeholder="Search plant.." style="width:100%;margin-bottom:8px;padding:7px 10px;border-radius:8px;border:none;font-size:15px;background:#2c4a2c;color:#e6f2e6;position:relative;z-index:2;display:block;box-sizing:border-box;" autocomplete="off" />
          <select id="plantSelect" size="1" style="width:100%;box-sizing:border-box;scrollbar-width:none;-ms-overflow-style:none;" onchange="updateBaseValue()">
            <optgroup label="Sam's Shop">
              <option value="18">Carrot ($18)</option>
              <option value="14">Strawberry ($14)</option>
              <option value="18">Blueberry ($18)</option>
              <option value="767">Orange Tulip ($767)</option>
              <option value="27">Tomato ($27)</option>
              <option value="36">Corn ($36)</option>
              <option value="903">Daffodil ($903)</option>
              <option value="2708">Watermelon ($2708)</option>
              <option value="3700">Pumpkin ($3700)</option>
              <option value="248">Apple ($248)</option>
              <option value="3610">Bamboo ($3610)</option>
              <option value="361">Coconut ($361)</option>
              <option value="3068">Cactus ($3068)</option>
              <option value="4287">Dragon Fruit ($4287)</option>
              <option value="5866">Mango ($5866)</option>
              <option value="7085">Grape ($7085)</option>
              <option value="136278">Mushroom ($136,278)</option>
              <option value="7220">Pepper ($7220)</option>
              <option value="9928">Cacao ($9928)</option>
              <option value="18050">Beanstalk ($18,050)</option>
            </optgroup>
            <optgroup label="Normal Seed Pack">
              <option value="500">Pear ($500)</option>
              <option value="90">Raspberry ($90)</option>
              <option value="1805">Pineapple ($1805)</option>
              <option value="271">Peach ($271)</option>
            </optgroup>
            <optgroup label="Exotic Seed Pack">
              <option value="1000">Papaya ($1000)</option>
              <option value="1579">Banana ($1579)</option>
              <option value="3204">Passionfruit ($3204)</option>
              <option value="3000">Soul Fruit (~$3000)</option>
              <option value="15000">Cursed Fruit (~$10k‚Äì20k)</option>
            </optgroup>
            <optgroup label="Easter 2025 Event">
              <option value="16500">Chocolate Carrot (~$16,500)</option>
              <option value="70000">Red Lollipop (~$70,000)</option>
              <option value="145000">Candy Sunflower (~$145,000)</option>
              <option value="4513">Easter Egg ($4513)</option>
              <option value="92567">Candy Blossom ($92,567)</option>
            </optgroup>
            <optgroup label="Angry Plant Event">
              <option value="1805">Cranberry ($1805)</option>
              <option value="4513">Durian ($4513)</option>
              <option value="6769">Eggplant ($6769)</option>
              <option value="17000">Venus Fly Trap (~$17,000)</option>
              <option value="20000">Lotus (~$20,000)</option>
            </optgroup>
            <optgroup label="Lunar Glow Event">
              <option value="2000">Nightshade ($2000)</option>
              <option value="175">Glowshroom (150‚Äì200)</option>
              <option value="6434">Mint ($6434)</option>
              <option value="8500">Moonflower (~$7k‚Äì10k)</option>
              <option value="15538">Starfruit ($15,538)</option>
              <option value="18000">Moonglow ($18,000)</option>
              <option value="45125">Moon Blossom ($45,125)</option>
            </optgroup>
            <optgroup label="Blood Moon Shop">
              <option value="5415">Blood Banana ($5415)</option>
              <option value="16245">Moon Melon ($16,245)</option>
            </optgroup>
            <optgroup label="Twilight Shop">
              <option value="7220">Celestiberry ($7220)</option>
              <option value="22563">Moon Mango ($22,563)</option>
            </optgroup>
            <optgroup label="Other">
              <option value="500">Lemon (~$500)</option>
              <option value="550">Cherry Blossom ($550)</option>
            </optgroup>
            <optgroup label="Bizzy Bee Event">
              <option value="N/A">Rose (N/A)</option>
              <option value="18050">Foxglove ($18,050)</option>
              <option value="31588">Lilac ($31,588)</option>
              <option value="58663">Pink Lily ($58,663)</option>
              <option value="67688">Purple Dahila ($67,688)</option>
              <option value="N/A">Nectarine (N/A)</option>
              <option value="6000">Hive Fruit ($6,000)</option>
              <option value="200000">Sunflower ($200,000)</option>
            </optgroup>
            <option value="custom">Custom</option>
          </select>
        </div>
      </label>
      <label id="baseValueLabel" style="display:none;">
        üí∞ Base Value:
        <input type="number" id="baseValue" value="10000" />
      </label>
      <label>‚öñÔ∏è Weight:
        <input type="number" id="weight" value="1" min="0" step="0.01" />
      </label>
      <label>üåü Core Mutation:</label>
      <div class="core-mutations" id="coreMutationContainer">
        <label class="mutation-item" style="color:rgb(110, 110, 110);">
          <input type="radio" name="coreMutation" value="1" checked /> üåë None (√ó1)
        </label>
        <label class="mutation-item" style="color:rgb(192, 206, 0);">
          <input type="radio" name="coreMutation" value="20" /> ‚ú® Golden (√ó20)
        </label>
        <label class="mutation-item">
          <input type="radio" name="coreMutation" value="50" />
          <b style="letter-spacing: 0em;">
            <span style="color:#FF0000;">R</span><span style="color:#FF7F00;">a</span><span style="color:#FFFF00;">i</span><span style="color:#00FF00;">n</span><span style="color:#0000FF;">b</span><span style="color:#4B0082;">o</span><span style="color:#9400D3;">w</span>
          </b> (√ó50)
        </label>
      </div>
      <label>üåø Environmental Mutations (Stack‚Äêbonus = original multiplier ‚àí 1):</label>
      <div class="env-mutations" id="envMutationsContainer">
        <label class="mutation-item" style="color: rgb(95, 196, 255);">
          <input type="checkbox" class="env-checkbox" value="1" data-name="Wet" id="wet" />
          üíß Wet (+1)
        </label>
        <label class="mutation-item" style="color: rgb(95, 196, 255);">
          <input type="checkbox" class="env-checkbox" value="1" data-name="Chilled" id="chilled" />
          ‚ùÑÔ∏è Chilled (+1)
        </label>
        <label class="mutation-item" style="color: rgb(95, 196, 255);">
          <input type="checkbox" class="env-checkbox" value="9" data-name="Frozen" id="frozen" />
          üßä Frozen (+9)
        </label>
        <label class="mutation-item" style="color: rgb(109, 56, 13);">
          <input type="checkbox" class="env-checkbox" value="1" data-name="Chocolate" id="chocolate" />
          üç´ Chocolate (+1)
        </label>
        <label class="mutation-item" style="color: rgb(167, 141, 238);">
          <input type="checkbox" class="env-checkbox" value="1" data-name="Moonlit" id="moonlit" />
          üåô Moonlit (+1)
        </label>
        <label class="mutation-item" style="color: rgb(184, 181, 42);">
          <input type="checkbox" class="env-checkbox" value="2" data-name="Pollinated" id="pollinated" />
          üêù Pollinated (+2)
        </label>
        <label class="mutation-item" style="color: rgb(94, 31, 31);">
          <input type="checkbox" class="env-checkbox" value="3" data-name="Bloodlit" id="bloodlit" />
          ü©∏ Bloodlit (+3)
        </label>
        <label class="mutation-item" style="color: rgb(221, 51, 255);">
          <input type="checkbox" class="env-checkbox" value="4" data-name="Plasma" id="plasma" />
          ‚ö° Plasma (+4)
        </label>
        <label class="mutation-item" style="color: rgb(255, 159, 33);">
          <input type="checkbox" class="env-checkbox" value="4" data-name="Honey Glazed" id="honeyglazed" />
          üçØ Honey Glazed (+4)
        </label>
        <label class="mutation-item" style="color: rgb(132, 173, 108);">
          <input type="checkbox" class="env-checkbox" value="24" data-name="Zombified" id="zombified" />
          üßü Zombified (+24)
        </label>
        <label class="mutation-item" style="color: rgb(28, 30, 138);">
          <input type="checkbox" class="env-checkbox" value="29" data-name="Twisted" id="twisted" />
          üåÄ Twisted (+29)
        </label>
        <label class="mutation-item" style="color: rgb(225, 253, 63);">
          <input type="checkbox" class="env-checkbox" value="99" data-name="Shocked" id="shocked" />
          ‚ö° Shocked (+99)
        </label>
        <label class="mutation-item" style="color: rgb(223, 18, 250);">
          <input type="checkbox" class="env-checkbox" value="119" data-name="Celestial" id="celestial" />
          üå† Celestial (+119)
        </label>
        <label class="mutation-item" style="color: rgb(242, 146, 255);">
          <input type="checkbox" class="env-checkbox" value="124" data-name="Disco" id="disco" />
          üåà Disco (+124)
        </label>
        <label class="mutation-item" style="color: rgb(73, 0, 73);">
          <input type="checkbox" class="env-checkbox" value="134" data-name="Voidtouched" id="voidtouched" />
          üåå Voidtouched (+134)
        </label>
      </div>
      <div class="result" id="result"></div>
    </main>
  </div>
  <script>
    function updateBaseValue() {
      const plantSelect = document.getElementById("plantSelect");
      const baseValueInput = document.getElementById("baseValue");
      const baseValueLabel = document.getElementById("baseValueLabel");
      const selectedValue = plantSelect.value;

      if (selectedValue === "custom") {
        baseValueLabel.style.display = "block";
        baseValueInput.value = "";
      } else {
        baseValueLabel.style.display = "none";
        baseValueInput.value = selectedValue;
      }

      calculate();
    }

    const frozenCheckbox = document.getElementById("frozen");
    const wetCheckbox = document.getElementById("wet");
    const chilledCheckbox = document.getElementById("chilled");

    function handleExclusiveCheckboxes(changedCheckbox) {
      if (changedCheckbox.checked) {
        if (changedCheckbox === frozenCheckbox) {
          wetCheckbox.checked = false;
          chilledCheckbox.checked = false;
        } else if (changedCheckbox === wetCheckbox) {
          frozenCheckbox.checked = false;
          chilledCheckbox.checked = false;
        } else if (changedCheckbox === chilledCheckbox) {
          frozenCheckbox.checked = false;
          wetCheckbox.checked = false;
        }
      }

      calculate();
    }

    frozenCheckbox.addEventListener('change', () => handleExclusiveCheckboxes(frozenCheckbox));
    wetCheckbox.addEventListener('change', () => handleExclusiveCheckboxes(wetCheckbox));
    chilledCheckbox.addEventListener('change', () => handleExclusiveCheckboxes(chilledCheckbox));

    function calculate() {
      const baseValue = parseFloat(document.getElementById("baseValue").value) || 0;
      const weight = parseFloat(document.getElementById("weight").value) || 0;

      const coreRadios = document.getElementsByName("coreMutation");
      let coreMultiplier = 1;
      for (const radio of coreRadios) {
        if (radio.checked) {
          coreMultiplier = parseFloat(radio.value);
          break;
        }
      }

      const envCheckboxes = document.querySelectorAll(".env-checkbox");
      let stackSum = 0;
      const selectedEnvNames = [];
      envCheckboxes.forEach(cb => {
        if (cb.checked) {
          stackSum += parseFloat(cb.value);
          selectedEnvNames.push(cb.getAttribute("data-name"));
        }
      });

      const totalGrowthMultiplier = coreMultiplier * (1 + stackSum);
      const estimatedValue = baseValue * totalGrowthMultiplier * weight;

      document.getElementById("result").innerHTML = `
        üåæ Base Value: ${baseValue.toLocaleString()}<br>
        üåø Stack Bonus (Environmental): +${stackSum.toLocaleString()}<br>
        ‚öñÔ∏è Weight: ${weight}
        <hr>
        <b>üí∞ Estimated Total Value: $${estimatedValue.toLocaleString(undefined, {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      })}</b>
      `;
    }

    const plantSelect = document.getElementById("plantSelect");
    const plantDropdownSearch = document.getElementById("plantDropdownSearch");

    plantSelect.size = 1;
    plantSelect.addEventListener('focus', function() {
      this.size = 8;
    });
    plantSelect.addEventListener('blur', function() {
      setTimeout(() => { this.size = 1; }, 120); 
    });
    plantSelect.addEventListener('change', function() {
      this.size = 1;
    });

    plantDropdownSearch.addEventListener('input', function() {
      const search = this.value.toLowerCase();
      for (const optgroup of plantSelect.getElementsByTagName('optgroup')) {
        let anyVisible = false;
        for (const option of optgroup.getElementsByTagName('option')) {
          const text = option.textContent.toLowerCase();
          const visible = text.includes(search);
          option.style.display = visible ? '' : 'none';
          if (visible) anyVisible = true;
        }
        optgroup.style.display = anyVisible ? '' : 'none';
      }
      for (const option of plantSelect.children) {
        if (option.tagName === 'OPTION') {
          const text = option.textContent.toLowerCase();
          option.style.display = text.includes(search) ? '' : 'none';
        }
      }
      plantSelect.size = 8;
    });
    plantDropdownSearch.addEventListener('keydown', function(e) {
      if (e.key === 'ArrowDown') {
        plantSelect.focus();
        plantSelect.size = 8;
        plantSelect.selectedIndex = 0;
      }
    });

    document.getElementById("plantSelect").addEventListener("change", updateBaseValue);
    document.getElementById("baseValue").addEventListener("input", calculate);
    document.getElementById("weight").addEventListener("input", calculate);
    document.querySelectorAll('input[name="coreMutation"]').forEach(radio => {
      radio.addEventListener('change', calculate);
    });
    document.querySelectorAll('.env-checkbox').forEach(cb => {
      cb.addEventListener('change', () => handleExclusiveCheckboxes(cb));
    });

    updateBaseValue();
  </script>
</body>
</html>
